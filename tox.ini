[tox]
min_version = 4.0
env_list = py39,py310,py311,coverage,security,docs

[testenv]
description = run unit tests
deps =
    pytest>=7.4.0
    pytest-cov>=4.1.0
    pytest-mock>=3.11.0
    pytest-xdist>=3.3.0
    hypothesis>=6.82.0
commands = pytest {posargs:tests}

[testenv:coverage]
description = run tests with coverage reporting
deps = {[testenv]deps}
commands = 
    pytest --cov=src --cov-report=term-missing --cov-report=html --cov-report=xml {posargs:tests}

[testenv:security]
description = run security checks with bandit
deps = bandit[toml]>=1.7.5
commands = bandit -r src/ -f json -o bandit-report.json

[testenv:docs]
description = build documentation
deps = 
    sphinx>=7.1.0
    sphinx-rtd-theme>=1.3.0
    myst-parser>=2.0.0
commands = 
    sphinx-build -b html docs/ docs/_build/html

[testenv:lint]
description = run linting checks
deps =
    black>=23.7.0
    isort>=5.12.0
    flake8>=6.0.0
    mypy>=1.5.0
commands =
    black --check src/ tests/
    isort --check-only src/ tests/
    flake8 src/ tests/
    mypy src/

[testenv:format]
description = format code
deps =
    black>=23.7.0
    isort>=5.12.0
commands =
    black src/ tests/
    isort src/ tests/